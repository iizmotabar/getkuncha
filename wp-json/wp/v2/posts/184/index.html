{"id":184,"date":"2013-01-04T16:40:01","date_gmt":"2013-01-04T11:40:01","guid":{"rendered":"http:\/\/18.139.242.7\/2013\/01\/04\/adding-multiple-google-analytics-tracking-codes-to-webpage\/"},"modified":"2013-01-04T16:40:01","modified_gmt":"2013-01-04T11:40:01","slug":"adding-multiple-google-analytics-tracking-codes-to-webpage","status":"publish","type":"post","link":"https:\/\/marketlytics.com\/blog\/adding-multiple-google-analytics-tracking-codes-to-webpage\/","title":{"rendered":"Adding multiple Google Analytics tracking codes to webpage"},"content":{"rendered":"<blockquote>\n<p>aka Tracking Google Analytics to Multiple Web Properties from a single page<\/p>\n<\/blockquote>\n<p>So let\u2019s say you want to send your sites analytics data to two google analytics web properties. To do this you would need to place the tracking code from the two properties on every page of the site. But you can\u2019t do it by just pasting both the codes as it is, instead we need to modify one of them to keep collecting data correctly.<\/p>\n<p>To do this copy the tracking code from both web properties.<\/p>\n<p>To get the tracking code go into <strong>Web Property &gt; Click Admin &gt; Click Tracking<\/strong> Info tab <!--more--><\/p>\n<p><strong>First Web Property<\/strong><\/p>\n<pre class=\"source-code\"><span class=\"cm-keyword\">var<\/span> <span class=\"cm-variable\">_gaq<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable\">_gaq<\/span> <span class=\"cm-operator\">||<\/span> [];\n<span class=\"cm-variable\">_gaq<\/span>.<span class=\"cm-property\">push<\/span>([<span class=\"cm-string\">'_setAccount'<\/span>, <span class=\"cm-string\">'UA-FIRST-WEBPROPERTY'<\/span>]);\n<span class=\"cm-variable\">_gaq<\/span>.<span class=\"cm-property\">push<\/span>([<span class=\"cm-string\">'_trackPageview'<\/span>]);\n\n(<span class=\"cm-keyword\">function<\/span>() {\n<span class=\"cm-keyword\">var<\/span> <span class=\"cm-def\">ga<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable\">document<\/span>.<span class=\"cm-property\">createElement<\/span>(<span class=\"cm-string\">'script'<\/span>); <span class=\"cm-variable-2\">ga<\/span>.<span class=\"cm-property\">type<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-string\">'text\/javascript'<\/span>; <span class=\"cm-variable-2\">ga<\/span>.<span class=\"cm-property\">async<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-atom\">true<\/span>;\n<span class=\"cm-variable-2\">ga<\/span>.<span class=\"cm-property\">src<\/span> <span class=\"cm-operator\">=<\/span> (<span class=\"cm-string\">'https:'<\/span> <span class=\"cm-operator\">==<\/span> <span class=\"cm-variable\">document<\/span>.<span class=\"cm-property\">location<\/span>.<span class=\"cm-property\">protocol<\/span> <span class=\"cm-operator\">?<\/span> <span class=\"cm-string\">'https:\/\/ssl'<\/span> : <span class=\"cm-string\">'https:\/\/www'<\/span>) <span class=\"cm-operator\">+<\/span> <span class=\"cm-string\">'.google-analytics.com\/ga.js'<\/span>;\n<span class=\"cm-keyword\">var<\/span> <span class=\"cm-def\">s<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable\">document<\/span>.<span class=\"cm-property\">getElementsByTagName<\/span>(<span class=\"cm-string\">'script'<\/span>)[<span class=\"cm-number\">0<\/span>]; <span class=\"cm-variable-2\">s<\/span>.<span class=\"cm-property\">parentNode<\/span>.<span class=\"cm-property\">insertBefore<\/span>(<span class=\"cm-variable-2\">ga<\/span>, <span class=\"cm-variable-2\">s<\/span>);\n})();<\/pre>\n<p>Do the same thing for <strong>Second Web Property<\/strong><\/p>\n<pre class=\"source-code\"><span class=\"cm-keyword\">var<\/span> <span class=\"cm-variable\">_gaq<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable\">_gaq<\/span> <span class=\"cm-operator\">||<\/span> [];\n<span class=\"cm-variable\">_gaq<\/span>.<span class=\"cm-property\">push<\/span>([<span class=\"cm-string\">'_setAccount'<\/span>, <span class=\"cm-string\">'UA-SECOND-WEBPROPERTY'<\/span>]);\n<span class=\"cm-variable\">_gaq<\/span>.<span class=\"cm-property\">push<\/span>([<span class=\"cm-string\">'_trackPageview'<\/span>]);\n(<span class=\"cm-keyword\">function<\/span>() {\n<span class=\"cm-keyword\">var<\/span> <span class=\"cm-def\">ga<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable\">document<\/span>.<span class=\"cm-property\">createElement<\/span>(<span class=\"cm-string\">'script'<\/span>); <span class=\"cm-variable-2\">ga<\/span>.<span class=\"cm-property\">type<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-string\">'text\/javascript'<\/span>; <span class=\"cm-variable-2\">ga<\/span>.<span class=\"cm-property\">async<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-atom\">true<\/span>;\n<span class=\"cm-variable-2\">ga<\/span>.<span class=\"cm-property\">src<\/span> <span class=\"cm-operator\">=<\/span> (<span class=\"cm-string\">'https:'<\/span> <span class=\"cm-operator\">==<\/span> <span class=\"cm-variable\">document<\/span>.<span class=\"cm-property\">location<\/span>.<span class=\"cm-property\">protocol<\/span> <span class=\"cm-operator\">?<\/span> <span class=\"cm-string\">'https:\/\/ssl'<\/span> : <span class=\"cm-string\">'https:\/\/www'<\/span>) <span class=\"cm-operator\">+<\/span> <span class=\"cm-string\">'.google-analytics.com\/ga.js'<\/span>;\n<span class=\"cm-keyword\">var<\/span> <span class=\"cm-def\">s<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable\">document<\/span>.<span class=\"cm-property\">getElementsByTagName<\/span>(<span class=\"cm-string\">'script'<\/span>)[<span class=\"cm-number\">0<\/span>]; <span class=\"cm-variable-2\">s<\/span>.<span class=\"cm-property\">parentNode<\/span>.<span class=\"cm-property\">insertBefore<\/span>(<span class=\"cm-variable-2\">ga<\/span>, <span class=\"cm-variable-2\">s<\/span>);\n})();<\/pre>\n<p>Now if you copy pasted both of the codes as it is into your pages your tracking would be incorrect, as both codes would overwrite analytics cookie that GA uses to track the visitor giving you wrong measurement in both web properties. [I have avoided technical reasoning but end result would be you would have 0 or close to zero bounce rates and a lot of self referrals \/ direct visits]<\/p>\n<p>To get both of them to work together we need to modify one of the codes. Let\u2019s change the second code by adding a prefix to all the _gaq.push calls sent to analytics.<\/p>\n<p>This prefix could be anything really. For brevity let\u2019s use <strong>b <\/strong>the prefix needs a <strong>. (dot)<\/strong> after it for separation. So it becomes <strong>b.<\/strong><\/p>\n<p><strong>Updating our second script we get<\/strong><\/p>\n<pre class=\"source-code\"><span class=\"cm-operator\">&lt;<\/span><span class=\"cm-variable\">script<\/span> <span class=\"cm-variable\">type<\/span><span class=\"cm-operator\">=<\/span><span class=\"cm-string\">\"text\/javascript\"<\/span><span class=\"cm-operator\">&gt;<\/span> <span class=\"cm-keyword\">var<\/span> <span class=\"cm-variable\">_gaq<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable\">_gaq<\/span> <span class=\"cm-operator\">||<\/span> []; <span class=\"cm-variable\">_gaq<\/span>.<span class=\"cm-property\">push<\/span>([<span class=\"cm-string\">'b._setAccount'<\/span>, <span class=\"cm-string\">'UA-SECOND-WEBPROPERTY'<\/span>]); <span class=\"cm-variable\">_gaq<\/span>.<span class=\"cm-property\">push<\/span>([<span class=\"cm-string\">'b._trackPageview'<\/span>]);<span class=\"cm-operator\">&lt;<\/span><span class=\"cm-string-2\">\/script&gt;<\/span><\/pre>\n<p>By modifying the code we are causing it to create a separate set of GA cookies for tracking data to second web property, hence overcoming the overwriting issue we were facing previously.<\/p>\n<p>We need to add prefix ALL calls in tracking script as well as any other event tracking or cross domain calls. Also note every action that you want to track to both properties would need to have tracking from both sets of properties.<\/p>\n<p><strong>For example<\/strong> if you wanted to track click on a link.<\/p>\n<pre class=\"source-code\"><span class=\"cm-operator\">&lt;<\/span><span class=\"cm-variable\">a<\/span> <span class=\"cm-variable\">href<\/span><span class=\"cm-operator\">=<\/span><span class=\"cm-string\">\"\/hello\"<\/span><span class=\"cm-operator\">&gt;<\/span> <span class=\"cm-variable\">Click<\/span> <span class=\"cm-variable\">Me<\/span><\/pre>\n<p>To add tracking for both properties we would<\/p>\n<pre class=\"source-code\"><span class=\"cm-operator\">&lt;<\/span><span class=\"cm-variable\">a<\/span> <span class=\"cm-variable\">href<\/span><span class=\"cm-operator\">=<\/span><span class=\"cm-variable\">\u201d<\/span><span class=\"cm-operator\">\/<\/span><span class=\"cm-variable\">hello\u201d<\/span> <span class=\"cm-variable\">onclick<\/span><span class=\"cm-operator\">=<\/span><span class=\"cm-variable\">\u201d_gaq<\/span>.<span class=\"cm-property\">push<\/span>([<span class=\"cm-variable\">\u2018_trackEvent\u2019<\/span>, <span class=\"cm-variable\">\u2018Hello<\/span> <span class=\"cm-variable\">Click\u2019<\/span>, <span class=\"cm-variable\">\u2018Click\u2019<\/span>, <span class=\"cm-variable\">\u2018link\u2019<\/span>]); <span class=\"cm-variable\">_gaq<\/span>.<span class=\"cm-property\">push<\/span>([<span class=\"cm-variable\">\u2018b<\/span>.<span class=\"cm-property\">_trackEvent\u2019<\/span>, <span class=\"cm-variable\">\u2018Hello<\/span> <span class=\"cm-variable\">Click\u2019<\/span>, <span class=\"cm-variable\">\u2018Click\u2019<\/span>, <span class=\"cm-variable\">\u2018link\u2019<\/span>]);<span class=\"cm-variable\">\u201d<\/span><span class=\"cm-operator\">&gt;<\/span> <span class=\"cm-variable\">Hello<\/span> <span class=\"cm-variable\">Click<\/span> <span class=\"cm-variable\">Me<\/span><span class=\"cm-operator\">&lt;<\/span><span class=\"cm-string-2\">\/a&gt;<\/span><\/pre>\n<p>\u00a0<\/p>\n<h2><strong>Cleaning up:<\/strong><\/h2>\n<p>We can shorten the second script to just this as rest of the code already exists in first script.<\/p>\n<pre class=\"source-code\"><span class=\"cm-operator\">&lt;<\/span><span class=\"cm-variable\">script<\/span> <span class=\"cm-variable\">type<\/span><span class=\"cm-operator\">=<\/span><span class=\"cm-string\">\"text\/javascript\"<\/span><span class=\"cm-operator\">&gt;<\/span> <span class=\"cm-keyword\">var<\/span> <span class=\"cm-variable\">_gaq<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable\">_gaq<\/span> <span class=\"cm-operator\">||<\/span> []; <span class=\"cm-variable\">_gaq<\/span>.<span class=\"cm-property\">push<\/span>([<span class=\"cm-string\">'b._setAccount'<\/span>, <span class=\"cm-string\">'UA-SECOND-WEBPROPERTY'<\/span>]); <span class=\"cm-variable\">_gaq<\/span>.<span class=\"cm-property\">push<\/span>([<span class=\"cm-string\">'b._trackPageview'<\/span>]); <span class=\"cm-operator\">&lt;<\/span><span class=\"cm-string-2\">\/script&gt;<\/span><\/pre>\n<p>In some cases you cant combine the script so you would just place the above script on the pages with the first tracking script.<\/p>\n<p>Ideally you should combine the first and second script in which case it would be written as:<\/p>\n<pre class=\"source-code\"><span class=\"cm-operator\">&lt;<\/span><span class=\"cm-variable\">script<\/span> <span class=\"cm-variable\">type<\/span><span class=\"cm-operator\">=<\/span><span class=\"cm-string\">\"text\/javascript\"<\/span><span class=\"cm-operator\">&gt;<\/span> <span class=\"cm-keyword\">var<\/span> <span class=\"cm-variable\">_gaq<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable\">_gaq<\/span> <span class=\"cm-operator\">||<\/span> []; <span class=\"cm-variable\">_gaq<\/span>.<span class=\"cm-property\">push<\/span>([<span class=\"cm-string\">'_setAccount'<\/span>, <span class=\"cm-string\">'UA-FIRST-WEBPROPERTY'<\/span>]); <span class=\"cm-variable\">_gaq<\/span>.<span class=\"cm-property\">push<\/span>([<span class=\"cm-string\">'_trackPageview'<\/span>]); <span class=\"cm-variable\">_gaq<\/span>.<span class=\"cm-property\">push<\/span>([<span class=\"cm-string\">'b._setAccount'<\/span>, <span class=\"cm-string\">'UA-SECOND-WEBPROPERTY'<\/span>]); <span class=\"cm-variable\">_gaq<\/span>.<span class=\"cm-property\">push<\/span>([<span class=\"cm-string\">'b._trackPageview'<\/span>]);\n\n(<span class=\"cm-keyword\">function<\/span>() { <span class=\"cm-keyword\">var<\/span> <span class=\"cm-def\">ga<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable\">document<\/span>.<span class=\"cm-property\">createElement<\/span>(<span class=\"cm-string\">'script'<\/span>); <span class=\"cm-variable-2\">ga<\/span>.<span class=\"cm-property\">type<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-string\">'text\/javascript'<\/span>; <span class=\"cm-variable-2\">ga<\/span>.<span class=\"cm-property\">async<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-atom\">true<\/span>; <span class=\"cm-variable-2\">ga<\/span>.<span class=\"cm-property\">src<\/span> <span class=\"cm-operator\">=<\/span> (<span class=\"cm-string\">'https:'<\/span> <span class=\"cm-operator\">==<\/span> <span class=\"cm-variable\">document<\/span>.<span class=\"cm-property\">location<\/span>.<span class=\"cm-property\">protocol<\/span> <span class=\"cm-operator\">?<\/span> <span class=\"cm-string\">'https:\/\/ssl'<\/span> : <span class=\"cm-string\">'https:\/\/www'<\/span>) <span class=\"cm-operator\">+<\/span> <span class=\"cm-string\">'.google-analytics.com\/ga.js'<\/span>; <span class=\"cm-keyword\">var<\/span> <span class=\"cm-def\">s<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable\">document<\/span>.<span class=\"cm-property\">getElementsByTagName<\/span>(<span class=\"cm-string\">'script'<\/span>)[<span class=\"cm-number\">0<\/span>]; <span class=\"cm-variable-2\">s<\/span>.<span class=\"cm-property\">parentNode<\/span>.<span class=\"cm-property\">insertBefore<\/span>(<span class=\"cm-variable-2\">ga<\/span>, <span class=\"cm-variable-2\">s<\/span>); })(); <span class=\"cm-operator\">&lt;<\/span><span class=\"cm-string-2\">\/script&gt;<\/span><\/pre>\n<div class=\"newsletter-form-wrapper newsletter-form-wrapper--layoutFloat newsletter-form-wrapper--alignCenter\"\n  \n><\/p>\n<form\n     class=\"newsletter-form\"\n     data-form-id=\"5805ef06bebafb1cca14fe50\"\n     \n     autocomplete=\"on\"\n     method=\"POST\"\n     onsubmit=\"return (function (form) {\n  Y.use('squarespace-form-submit', 'node', function usingFormSubmit(Y) {\n    (new Y.Squarespace.FormSubmit(form)).submit({\n      formId: '5805ef06bebafb1cca14fe50',\n      collectionId: '',\n      objectName: 'post-56613860e4b0ab9085182a21'\n    });\n  });\n  return false;\n})(this);\"\n  ><\/p>\n<header class=\"newsletter-form-header\">\n<div class=\"newsletter-form-header-description\">\n<p><strong>Everything you need to know about Digital Analytics, delivered every month<\/strong><\/p>\n<\/div>\n<\/header>\n<div class=\"newsletter-form-body\">\n<div class=\"newsletter-form-fields-wrapper form-fields\">\n<div id=\"email-yui_3_17_2_1_1476781976700_158038\" class=\"newsletter-form-field-wrapper form-item field email required\">\n              <label class=\"newsletter-form-field-label title\" for=\"email-yui_3_17_2_1_1476781976700_158038-field\">Email Address<\/label><br \/>\n              <input id=\"email-yui_3_17_2_1_1476781976700_158038-field\" class=\"newsletter-form-field-element field-element\" name=\"email\" x-autocompletetype=\"email\" type=\"text\" spellcheck=\"false\" placeholder=\"Email Address\" \/>\n            <\/div>\n<\/p><\/div>\n<div class=\"newsletter-form-button-wrapper submit-wrapper\">\n        <button class=\"newsletter-form-button sqs-system-button sqs-editable-button-layout sqs-editable-button-style sqs-editable-button-shape\" type=\"submit\" value=\"Subscribe\"><span class=\"newsletter-form-spinner sqs-spin light large\"><\/span><span class=\"newsletter-form-button-label\">Subscribe<\/span><span class=\"newsletter-form-button-icon\"><\/span><\/button>\n      <\/div>\n<\/p><\/div>\n<div class=\"newsletter-form-footnote\">\n<p>We respect your privacy.<\/p>\n<\/div>\n<div class=\"hidden form-submission-text\">\n<p>Please check your inbox to verify the subscription. Thank you!<\/p>\n<\/div>\n<div class=\"hidden form-submission-html\" data-submission-html=\"\"><\/div>\n<\/p><\/form>\n<\/div>\n","protected":false},"excerpt":{"rendered":"<p><span style=\"font-size:13px\">Step by step instructions for adding multiple Google Analytics tracking code on the same web page without interrupting the reports. Included the scripts<\/span><\/p>\n","protected":false},"author":5,"featured_media":185,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"content-type":"","footnotes":""},"categories":[3],"tags":[61,85,88],"acf":[],"aioseo_notices":[],"_links":{"self":[{"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/posts\/184"}],"collection":[{"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/users\/5"}],"replies":[{"embeddable":true,"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/comments?post=184"}],"version-history":[{"count":0,"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/posts\/184\/revisions"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/media\/185"}],"wp:attachment":[{"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/media?parent=184"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/categories?post=184"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/tags?post=184"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}