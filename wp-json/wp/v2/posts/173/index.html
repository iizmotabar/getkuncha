{"id":173,"date":"2013-10-24T13:36:51","date_gmt":"2013-10-24T08:36:51","guid":{"rendered":"http:\/\/18.139.242.7\/2013\/10\/24\/adwords-offline-conversion-tracking\/"},"modified":"2013-10-24T13:36:51","modified_gmt":"2013-10-24T08:36:51","slug":"adwords-offline-conversion-tracking","status":"publish","type":"post","link":"https:\/\/marketlytics.com\/blog\/adwords-offline-conversion-tracking\/","title":{"rendered":"Adwords Offline Conversion Tracking"},"content":{"rendered":"<p>Google Adwords recently released an ability to <a target=\"_blank\" href=\"https:\/\/support.google.com\/adwords\/answer\/2998031\" rel=\"noopener noreferrer\">record offline conversions<\/a>. Doing this in the past was a mess requiring lot of custom code and integration with backend crm system. The new method is much more straight forward not to mention officially sanctioned :). Below is meant as technical intro to the implementation. For all the steps to follow please review the <a target=\"_blank\" href=\"https:\/\/support.google.com\/adwords\/answer\/2998031\" rel=\"noopener noreferrer\">support page<\/a><\/p>\n<p>There are 3 main steps to the integration. 1- First you need to add this script to all pages. This detects whenever a user comes from adwords and stores their ad click id (gclid) in a cookie.<\/p>\n<p>Add this code before closing \/body&gt;<\/p>\n<pre class=\"source-code\"><span class=\"cm-tag cm-bracket\">&lt;<\/span><span class=\"cm-tag\">script<\/span> <span class=\"cm-attribute\">type<\/span>=<span class=\"cm-string\">\"text\/javascript\"<\/span><span class=\"cm-tag cm-bracket\">&gt;<\/span>\n<span class=\"cm-keyword\">function<\/span> <span class=\"cm-variable\">setCookie<\/span>(<span class=\"cm-def\">name<\/span>, <span class=\"cm-def\">value<\/span>, <span class=\"cm-def\">days<\/span>){\n    <span class=\"cm-keyword\">var<\/span> <span class=\"cm-def\">date<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-keyword\">new<\/span> <span class=\"cm-variable\">Date<\/span>();\n    <span class=\"cm-variable-2\">date<\/span>.<span class=\"cm-property\">setTime<\/span>(<span class=\"cm-variable-2\">date<\/span>.<span class=\"cm-property\">getTime<\/span>() <span class=\"cm-operator\">+<\/span> (<span class=\"cm-variable-2\">days<\/span><span class=\"cm-operator\">*<\/span><span class=\"cm-number\">24<\/span><span class=\"cm-operator\">*<\/span><span class=\"cm-number\">60<\/span><span class=\"cm-operator\">*<\/span><span class=\"cm-number\">60<\/span><span class=\"cm-operator\">*<\/span><span class=\"cm-number\">1000<\/span>)); \n    <span class=\"cm-keyword\">var<\/span> <span class=\"cm-def\">expires<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-string\">\"; expires=\"<\/span> <span class=\"cm-operator\">+<\/span> <span class=\"cm-variable-2\">date<\/span>.<span class=\"cm-property\">toGMTString<\/span>();\n    <span class=\"cm-variable\">document<\/span>.<span class=\"cm-property\">cookie<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable-2\">name<\/span> <span class=\"cm-operator\">+<\/span> <span class=\"cm-string\">\"=\"<\/span> <span class=\"cm-operator\">+<\/span> <span class=\"cm-variable-2\">value<\/span> <span class=\"cm-operator\">+<\/span> <span class=\"cm-variable-2\">expires<\/span> <span class=\"cm-operator\">+<\/span> <span class=\"cm-string\">\";path=\/\"<\/span>;\n}\n<span class=\"cm-keyword\">function<\/span> <span class=\"cm-variable\">getParam<\/span>(<span class=\"cm-def\">p<\/span>){\n    <span class=\"cm-keyword\">var<\/span> <span class=\"cm-def\">match<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable\">RegExp<\/span>(<span class=\"cm-string\">'[?&amp;]'<\/span> <span class=\"cm-operator\">+<\/span> <span class=\"cm-variable-2\">p<\/span> <span class=\"cm-operator\">+<\/span> <span class=\"cm-string\">'=([^&amp;]*)'<\/span>).<span class=\"cm-property\">exec<\/span>(<span class=\"cm-variable\">window<\/span>.<span class=\"cm-property\">location<\/span>.<span class=\"cm-property\">search<\/span>);\n    <span class=\"cm-keyword\">return<\/span> <span class=\"cm-variable-2\">match<\/span> <span class=\"cm-operator\">&amp;&amp;<\/span> <span class=\"cm-variable\">decodeURIComponent<\/span>(<span class=\"cm-variable-2\">match<\/span>[<span class=\"cm-number\">1<\/span>].<span class=\"cm-property\">replace<\/span>(<span class=\"cm-string-2\">\/\\+\/g<\/span>, <span class=\"cm-string\">' '<\/span>));\n}\n<span class=\"cm-keyword\">var<\/span> <span class=\"cm-variable\">gclid<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable\">getParam<\/span>(<span class=\"cm-string\">'gclid'<\/span>);\n<span class=\"cm-keyword\">if<\/span>(<span class=\"cm-variable\">gclid<\/span>){\n    <span class=\"cm-keyword\">var<\/span> <span class=\"cm-variable\">gclsrc<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable\">getParam<\/span>(<span class=\"cm-string\">'gclsrc'<\/span>);\n    <span class=\"cm-keyword\">if<\/span>(<span class=\"cm-operator\">!<\/span><span class=\"cm-variable\">gclsrc<\/span> <span class=\"cm-operator\">||<\/span> <span class=\"cm-variable\">gclsrc<\/span>.<span class=\"cm-property\">indexOf<\/span>(<span class=\"cm-string\">'aw'<\/span>) <span class=\"cm-operator\">!==<\/span> <span class=\"cm-operator\">-<\/span><span class=\"cm-number\">1<\/span>){\n        <span class=\"cm-variable\">setCookie<\/span>(<span class=\"cm-string\">'gclid'<\/span>, <span class=\"cm-variable\">gclid<\/span>, <span class=\"cm-number\">90<\/span>);\n    }\n}\n<span class=\"cm-tag cm-bracket\">&lt;\/<\/span><span class=\"cm-tag\">script<\/span><span class=\"cm-tag cm-bracket\">&gt;<\/span> <\/pre>\n<p>2- The forms on the site need to be updated with a new form field. This field would be hidden on the form itself and a script would be added to the page that will autopopulate it with a google adwords id (gclid).<\/p>\n<p>If you are using a crm \/ email system like salesforce, infusionsoft, aweber you will need to add the new field in their backend and map it to the new form field.<\/p>\n<p>Set the id of the new form field you created to gclid.<\/p>\n<pre>&lt;input type=\"hidden\" id=\"gclid\" name=\"gclid\" value=\"\"&gt;<\/pre>\n<p>Add this script before \/body&gt; on the form page(s).<\/p>\n<pre class=\"source-code\"> <span class=\"cm-tag cm-bracket\">&lt;<\/span><span class=\"cm-tag\">script<\/span><span class=\"cm-tag cm-bracket\">&gt;<\/span> \n  <span class=\"cm-keyword\">function<\/span> <span class=\"cm-variable\">readCookie<\/span>(<span class=\"cm-def\">name<\/span>) { \n  <span class=\"cm-keyword\">var<\/span> <span class=\"cm-def\">n<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable-2\">name<\/span> <span class=\"cm-operator\">+<\/span> <span class=\"cm-string\">\"=\"<\/span>; \n  <span class=\"cm-keyword\">var<\/span> <span class=\"cm-def\">cookie<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable\">document<\/span>.<span class=\"cm-property\">cookie<\/span>.<span class=\"cm-property\">split<\/span>(<span class=\"cm-string\">';'<\/span>); \n  <span class=\"cm-keyword\">for<\/span>(<span class=\"cm-keyword\">var<\/span> <span class=\"cm-def\">i<\/span><span class=\"cm-operator\">=<\/span><span class=\"cm-number\">0<\/span>;<span class=\"cm-variable-2\">i<\/span> <span class=\"cm-operator\">&lt;<\/span> <span class=\"cm-variable-2\">cookie<\/span>.<span class=\"cm-property\">length<\/span>;<span class=\"cm-variable-2\">i<\/span><span class=\"cm-operator\">++<\/span>) {      \n      <span class=\"cm-keyword\">var<\/span> <span class=\"cm-def\">c<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable-2\">cookie<\/span>[<span class=\"cm-variable-2\">i<\/span>];      \n      <span class=\"cm-keyword\">while<\/span> (<span class=\"cm-variable-2\">c<\/span>.<span class=\"cm-property\">charAt<\/span>(<span class=\"cm-number\">0<\/span>)<span class=\"cm-operator\">==<\/span><span class=\"cm-string\">' '<\/span>){<span class=\"cm-variable-2\">c<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-variable-2\">c<\/span>.<span class=\"cm-property\">substring<\/span>(<span class=\"cm-number\">1<\/span>,<span class=\"cm-variable-2\">c<\/span>.<span class=\"cm-property\">length<\/span>);}      \n      <span class=\"cm-keyword\">if<\/span> (<span class=\"cm-variable-2\">c<\/span>.<span class=\"cm-property\">indexOf<\/span>(<span class=\"cm-variable-2\">n<\/span>) <span class=\"cm-operator\">==<\/span> <span class=\"cm-number\">0<\/span>){<span class=\"cm-keyword\">return<\/span> <span class=\"cm-variable-2\">c<\/span>.<span class=\"cm-property\">substring<\/span>(<span class=\"cm-variable-2\">n<\/span>.<span class=\"cm-property\">length<\/span>,<span class=\"cm-variable-2\">c<\/span>.<span class=\"cm-property\">length<\/span>);} \n  } \n  <span class=\"cm-keyword\">return<\/span> <span class=\"cm-atom\">null<\/span>; \n  } \n\n  <span class=\"cm-variable\">window<\/span>.<span class=\"cm-property\">onload<\/span> <span class=\"cm-operator\">=<\/span> <span class=\"cm-keyword\">function<\/span>() {      \n      <span class=\"cm-variable\">document<\/span>.<span class=\"cm-property\">getElementById<\/span>(<span class=\"cm-string\">'gclid_field'<\/span>).<span class=\"cm-property\">value<\/span> <span class=\"cm-operator\">=<\/span> \n  <span class=\"cm-variable\">readCookie<\/span>(<span class=\"cm-string\">'gclid'<\/span>); \n  } \n  <span class=\"cm-tag cm-bracket\">&lt;\/<\/span><span class=\"cm-tag\">script<\/span><span class=\"cm-tag cm-bracket\">&gt;<\/span><\/pre>\n<p id=\"yui_3_17_2_1_1451912352810_88264\">This script will autopopulate the new field with gclid.<\/p>\n<p>3- On the backend in your crm you will need to generate a report of people who have converted and have the gclid set this data would then be added to a csv file according <a data-cke-saved-href=\"https:\/\/www.gstatic.com\/conversiontracking\/conversion-import-template.csv\" href=\"https:\/\/www.gstatic.com\/conversiontracking\/conversion-import-template.csv\">google&#8217;s format<\/a> and uploaded it to adwords.<\/p>\n<p>This makes it much easier to import offiline conversion data into adwords the actual formatting and upload could be automated as well making this even simpler (this is something we are cooking on for a client, stay tuned)<\/p>\n","protected":false},"excerpt":{"rendered":"<p><span style=\"font-size:13px\">Measure what happens to a click on your ad in offline world by understanding Adwords Offline Conversion Tracking. Learn importing offline conversions.<\/span><\/p>\n","protected":false},"author":5,"featured_media":174,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"content-type":"","footnotes":""},"categories":[3],"tags":[13,67,85,90],"acf":[],"aioseo_notices":[],"_links":{"self":[{"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/posts\/173"}],"collection":[{"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/users\/5"}],"replies":[{"embeddable":true,"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/comments?post=173"}],"version-history":[{"count":0,"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/posts\/173\/revisions"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/media\/174"}],"wp:attachment":[{"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/media?parent=173"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/categories?post=173"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/marketlytics.com\/wp-json\/wp\/v2\/tags?post=173"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}